<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home | Used Guitars and Broken Dreams</title>
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" 
    rel="stylesheet">
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" 
    rel="stylesheet">
  <link href="static/css/style.css" rel="stylesheet">

  <!-- Carichiamo Vue 3 dal CDN -->
  <script src="https://unpkg.com/vue@3" defer></script>
</head>
<body>
  <div id="home-app">

    <!-- Navbar come componente -->
    <navbar-x      
    :is-authenticated="isAuthenticated"
      :user="user"
      @show-auctions="showAuctions"
      @show-users="showUsers"
      @show-user-auctions="showUserAuctions"
      @show-user-bids="showUserBids"
      @logout="logout"
    ></navbar-x>

    <!-- Sezione “auctions” -->
    <auction-list
      v-if="currentView === 'auctions'"
      :filtered-auctions="filteredAuctions"
      :search-query="searchQuery"
      :is-authenticated="isAuthenticated"
      :user="user"
      @filter-auctions="filterAuctions"
      @show-create-auction-modal="showCreateAuctionModal"
      @select-auction="showAuctionDetails"
      @edit-auction="showEditAuctionDetails"
      @delete-auction="deleteAuction"
    ></auction-list>

    <!-- Sezione “users” -->
    <users-list
      v-else-if="currentView === 'users'"
      :filtered-users="filteredUsers"
      :search-query-users="searchQueryUsers"
      @filter-users="filterUsers"
      @select-user="showUserDetails"
    ></users-list>

    <!-- Sezione “user-auctions” -->
    <user-auctions
      v-else-if="currentView === 'user-auctions'"
      :auctions="selectedUserCreatedAuctions"
      :is-authenticated="isAuthenticated"
      :user="user"
      @selectAuction="showAuctionDetails"
      @editAuction="showEditAuctionDetails"
      @deleteAuction="deleteAuction"
    ></user-auctions>

    <!-- Sezione “user-bids” -->
    <user-bids
      v-else-if="currentView === 'user-bids'"
      :auctions="selectedUserWonAuctions"
      @selectAuction="showAuctionDetails"
    ></user-bids>

    <!-- Sezione “auction-details” -->
    <auction-details
      v-else-if="currentView === 'auction-details'"
      :selected-auction="selectedAuction"
      :auction-bids="auctionBids"
      :is-authenticated="isAuthenticated"
      :new-bid-amount="newBidAmount"
      @back="showAuctions"
      @place-bid="placeBid"
    ></auction-details>

    <!-- Sezione “selected-user-details” -->
    <selected-user-details
      v-else-if="currentView === 'selected-user-details'"
      :selected-user="selectedUser"
      :selected-user-created-auctions="selectedUserCreatedAuctions"
      :selected-user-won-auctions="selectedUserWonAuctions"
      @back="showUsers"
      @select-auction="showAuctionDetails"
    ></selected-user-details>

    <!-- Modale Creazione Asta -->
    <create-auction-modal
      :new-auction="newAuction"
      @handle-file-upload="handleFileUpload"
      @create-auction="createAuction"
    ></create-auction-modal>

    <!-- Modale Edit Asta -->
    <edit-auction-modal
      :edited-auction="editedAuction"
      @edit-auction="editAuction"
    ></edit-auction-modal>

  </div>

  <footer class="text-center py-3">
    <p>Used Guitars and Broken Dreams.</p>
  </footer>

  <!-- Bootstrap JS -->
  <script 
    src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js">
  </script>
  <script 
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js">
  </script>

  <!-- Il nostro script principale in modalità module -->
  <script type="module" src="static/js/home.js" defer></script>
</body>
</html>
